this is new code developed to be merged on github
